## Перенос модели из одной среды в другую

Предположим, что на некотором наборе признаков уже обучена модель, но все данные, из которых была составлена обучающая выборка, приходили из одной среды, а теперь хочется решать аналогичную задачу для объектов, приходящих из другой среды, где доступны только признаковые описания, но не целевые переменные.

Примеры подобных ситуаций таковы:

* Для решения задачи кредитного скоринга банк, работавший в некотором регионе, собрал достаточно размеченных примеров с жителями этого региона. Теперь банк хочет открыть отделение в другом регионе, однако там за короткое время можно собрать только заявки на кредит с признаками, но без целевой переменной, ведь для того, чтобы узнать, будет ли кредит возвращён, нужно ждать несколько лет.

* Мобильное приложение с моделью монетизации freemium (установка и базовое использование бесплатны, платны дополнительные возможности), долгое время выпускавшееся лишь под одну платформу, получило версию под другую платформу. Маркетологи хотят получать предсказание будущих поступлений от пользователей, привлекаемых в версию под новую платформу той или иной рекламной кампанией. Прямо сейчас доступны только параметры аудиторий и рекламных кампаний, но не конечный результ, ведь для его измерения необходимо ждать время, равное некой высокой квантили срока активности пользователя в приложении.

До тех пор, пока в новой среде не собрано достаточное количество размеченных данных, можно задействовать урезанную версию модели, обученную на данных из старой среды. Строится она так:

* Признаковые описания объектов из обеих сред вертикально конкатенируются, а новой целевой переменной становится бинарная переменная, равная 0, если объект пришёл из одной среды, и 1, если из другой.

* Обучается классификатор примерно той же природы, что и исходная модель, и смотрится, какие признаки обладают для него наибольшей важностью.

* Ищется подмножество признаков, такое что на нём классификатор не может показать хорошие метрики качества. Это подмножество признаков — подмножество таких признаков, что они с точки зрения моделей, похожих на выбранный классификатор, в совокупности выглядят одинаково в обеих средах.

* На отобранном подмножестве признаков только на объектах из старой среды обучается модель для исходной задачи, и именно эту модель можно использовать для предсказаний на объектах из новой среды.

Описанный приём позволяет избежать ошибок экстраполяции, связанных с тем, что модель применяется в ранее не виденных ей областях признакового пространства. В то же время использование лишь части признаков приводит к некоторому снижению качества модели. Стало быть, нужно найти оптимальный баланс между качеством модели и степенью различия между средами.
